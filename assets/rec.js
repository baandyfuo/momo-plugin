(function(window){function ismdef(n){for(var t=0;t<n.length;t++)if(isdef(n[t])==!1)return!1;return!0}function isdef(v){return v==""?!1:eval("typeof "+v)!=undef}function createjs(n){var t=document.createElement("script");return t.setAttribute("type","text/javascript"),t.setAttribute("src",n),t}function includejs(n){var t=document.getElementsByTagName("head")[0];t?t.appendChild(createjs(n)):document.body.appendChild(createjs(n))}function importJS(n,t,i,r){isdef(t)==!1?(includejs(n),wait_load(t,function(){i&&i(),r&&r()})):r&&r()}function wait_load(n,t){var i=setInterval(function(){isdef(n)&&(clearInterval(i),t())},50)}function registerclick(){var n=0;jQuery(document).mousedown(function(t){var i,r,u;try{if(n==0)n=new Date;else{if(i=new Date,i-n<1e3)return;n=i}ismdef(["window.scupioec","window.scupioec.rec","window.scupioec.rec[0]","window.scupioec.rec[0].c","window.scupioec.rec[0].c.mid"])&&window.scupioec.rec[0].c.mid=="2"&&(r=jQuery(window),u=jQuery(document),window.scupioec.call({mid:window.scupioec.rec[0].c.mid,act:"mc",mc:t.clientX+","+t.clientY+";"+t.screenX+","+t.screenY+";"+t.pageX+","+t.pageY+";"+screen.width+","+screen.height+";"+screen.availWidth+","+screen.availHeight+";"+r.scrollLeft()+","+r.scrollTop()+";"+u.width()+","+u.height()+";1"}))}catch(f){}}),jQuery(document).ready(function(){if(ismdef(["window.scupioec","window.scupioec.rec","window.scupioec.rec[0]","window.scupioec.rec[0].c","window.scupioec.rec[0].c.mid"])&&window.scupioec.rec[0].c.mid=="2"){var n=[],t=(new Date).getTime(),i,r,u,f,e,o;jQuery(document).mousemove(function(n){i=n.clientX,r=n.clientY,u=n.screenX,f=n.screenY,e=n.pageX,o=n.pageY}),jQuery("iframe").each(function(i,r){var u=t+"sc"+i;jQuery(r).addClass(u),n[i]=!1,jQuery("."+t+"sc"+i).mouseover(function(){n[i]=!0}).mouseout(function(){n[i]=!1})}),jQuery(window).bind("blur",function(){for(frame=0;frame<n.length;frame++)if(n[frame]){var t=jQuery(window),s=jQuery(document);window.scupioec.call({mid:window.scupioec.rec[0].c.mid,act:"mc",mc:i+","+r+";"+u+","+f+";"+e+","+o+";"+screen.width+","+screen.height+";"+screen.availWidth+","+screen.availHeight+";"+t.scrollLeft()+","+t.scrollTop()+";"+s.width()+","+s.height()+";2;"+frame+";"+jQuery("iframe").get(frame).id+";"+jQuery("iframe").get(frame).src})}})}})}function now(){return+new Date}function ck(){for(var t="",u=document.cookie.split(";"),n,i=0;i<u.length;i++){if(n=jQuery.trim(u[i]),n.indexOf("SID=")==0&&(t=t+";"+n),n.indexOf("__utmz=")==0){var f=n.match(/\.utmcsr\=([^|]+)/),e=n.match(/utmccn\=([^|]+)/),o=n.match(/utmcmd\=([^|]+)/),r="";r+=f!=null?f[1]+"|":"|",r+=e!=null?e[1]+"|":"|",o!=null&&(r+=o[1]),t=t+";ga="+r}n.indexOf("ScupioOrETU=")==0&&(t=t+";"+n)}return t}function ShouldQU(){for(var t=document.cookie.split(";"),i,n=0;n<t.length;n++)if(i=jQuery.trim(t[n]),i.indexOf("eupkg=full")==0)return!1;return!0}function ifOldIE(){try{if($.browser.msie){var n=parseFloat($.browser.version);if(n<9)return!0}}catch(t){}return!1}function GetCurrentURL(){try{var n=top.location.href;if(n&&n!="about:blank")return n}catch(t){}try{return location.href}catch(t){}return""}function GetReferrerURL(){try{var n=top.document.referrer;if(n)return n}catch(t){}return""}function CheckIfQU(){var r,u,n,i,s,f,h;if(ifOldIE())return"0";if(r=document.location.href,u=getParam(r,"ref"),u.length<=5)return"-2";n=[],n.push(u),n.push(r),n.push(GetCurrentURL()),n.push(GetReferrerURL());var t="bwrectarea",e="bwrectitem",o=jQuery("#"+t);for(o.length==0&&(jQuery("body").append('<style type="text/css">.bwrect A:link {text-decoration: none;color:#FF0000;} .bwrect A:visited {text-decoration: none;color: #0000FF;}<\/style><div id="'+t+'" class="bwrect" style="display:none"><\/div>'),o=jQuery("#"+t)),i=0;i<n.length;i++)if(s=n[i],jQuery("#"+t).html('<a id="'+e+'" href="'+s+'">test<\/a>'),f=jQuery("#"+e).css("color"),h=f=="rgb(0, 0, 255)"||f=="#0000ff",h)return"0";return"-1"}function getParam(n,t){try{var i=RegExp("[?|&]"+t+"=(.+?)(&|$)").exec(n);if(i)return decodeURIComponent(i[1])}catch(r){}return""}function bwRecEn(){for(var i="BWRecEn=",r="",u=document.cookie.split(";"),t,n=0;n<u.length;n++)t=jQuery.trim(u[n]),t.indexOf(i)==0&&(r=t.substring(i.length,t.length));return unescape(r)}function setCookie(n,t,i,r,u,f){n&&(n=n+"="+escape(t)+";",i=i?"expires="+new Date((new Date).getTime()+i*864e5).toGMTString()+";":"",r=r?"path="+r+";":"path=/;",u=u?"domain="+u+";":"",f=f?"secure=true;":"",document.cookie=[n,i,r,u,f].join(""))}function initscupioec(){return window.scupioec||(window.scupioec={vt:now()+"_"+Math.floor(Math.random()*1e4),u:GetCurrentURL(),r:GetReferrerURL(),msi:ck(),bw:bwRecEn(),rec:[],SetCookie:function(n,t,i,r,u,f){setCookie(n,t,i,r,u,f)},flush:function(){for(window.__scupio_r=window.__scupio_r||[];window.__scupio_r.length;)window.scupioec.call(window.__scupio_r.shift())},call:function(n){var i=initscupioec(),t={};t.c=n,t.n=null,i.rec.push(t),callaspx(i)}}),window.scupioec}function scupioec(){var executed="executed",ec=initscupioec(),srcregex=new RegExp("rec.scupio.com/recweb/js/rec([^.]*).js","i"),scripts=jQuery("script"),i,scriptnode,recnode;if(scripts!=null)for(i=0;i<scripts.length;i++)if(srcregex.test(scripts[i].src)&&(scriptnode=jQuery(scripts[i]),!(scripts[i].className.indexOf(executed)>-1)&&(scriptnode.addClass(executed),scriptnode.html().length>0)))return eval("var config="+scriptnode.html()+";"),recnode={},recnode.c=config,recnode.n=scriptnode,ec.rec.push(recnode),ec;return null}function DoJqueryNoConflict(){if(typeof window.$.blockUI!="function"){var n=window.$;jQuery.noConflict(),typeof window.$=="undefined"?window.$=n:typeof window.$.BlockUI=="function"&&(jQuery=window.$)}}function jqueryReady(n){var t="jQuery";importJS(schemevar+"code.jquery.com/jquery-1.7.2.min.js",t,function(){DoJqueryNoConflict()},function(){importJS(schemevar+"rec.scupio.com/recweb/js/jquery.js",t,function(){DoJqueryNoConflict()},n)})}function hasstr(n){return typeof n=="string"?n.length>0:!1}function umallfix(ecobj){var jscontents,i,idxbegin,dstr,ritemtxt,ii;if(document.location.href.indexOf("u-mall.com.tw")!=-1&&(jscontents=jQuery("script"),jscontents!=null))for(i=0;i<jscontents.length;i++){var scriptnode=jQuery(jscontents[i]),txt=scriptnode.html(),idxend=txt.indexOf('jQuery("#ca_top_board").tmpl(data.adv).appendTo("#ca_top_board_main");');if(idxend!=-1&&(idxbegin=txt.indexOf("var data"),dstr=txt.substring(idxbegin,idxend),eval(dstr),eval("typeof data")=="object")){for(ritemtxt="",ii=0;ii<data.adv.length;ii++)ritemtxt+=data.adv[ii].topSaleCode+",";ecobj.ritem=ritemtxt;return}}}function obdesignbuyfix(n){var r,t,i;if(document.location.href.indexOf("obdesign.com.tw")!=-1){r=[];try{if(t=jQuery("#Label訂單編號1").text(),t==""||t==null||t==undefined)return;r.push("order:"+t),i="",jQuery.each(jQuery("#shop_list > tbody").find("tr"),function(n){var f,t;if(n>0){var e=jQuery(this).find("td").eq(0).find("img").attr("src"),r=e.split(/catalog\/[^/]+\/([^\.]+)\.jpg/ig),o=r[1].substring(0,r[1].length-1),s=jQuery(this).find("td").eq(4).text(),u=jQuery(this).find("td").eq(5).text();i+=o+","+u+","+s+",",f=jQuery(this).find("td").eq(6).text(),t=parseInt(f)-parseInt(u),t<0&&(i+="__discount,"+t+",1,")}});var e=jQuery("#Label商品金額總計1").text(),u=jQuery("#shop_list > tfoot").find("tr").eq(1).find("td").eq(1).text(),f=jQuery("#Label購物金額總計1").text();i+=u==""||u==null?"__sum,"+f+",1,":"__shipping,"+u+",1,__sum,"+f+",1,",r.push("bitem:"+i),n.pmitem=r.join("^")}catch(o){}return}}function obdesigncartfix(n){if(document.location.href.indexOf("obdesign.com.tw")!=-1){var t=[];try{jQuery.each(jQuery("#shop_list > tbody").find("tr"),function(){var f=jQuery(this).find("td").eq(1).find("a").attr("href"),i=f.split(/product.aspx\?seriesID=([^&]+)/ig),n,r,u;i.length>1&&(n=i[1],n!=""&&n!=null&&n!=undefined&&(n.match(/\&no=/)||(r=jQuery(this).find("td").eq(4).find("select option:selected").text(),u=jQuery(this).find("td").eq(5).text(),t.push(n+","+u+","+r))))}),n.pmitem="cart:"+t.join(",")}catch(i){}return}}function callaspx(ecobj){var datafunc,func,datastr,qustr;if(ecobj!=null){var ec_rec_index=ecobj.rec.length-1,ec_rec=ecobj.rec[ec_rec_index],ec_config=ec_rec.c,ec_node=ec_rec.n;if(ec_config.vidx=ec_rec_index,ec_config.vt=ecobj.vt,ec_config.mid!="none"){if(typeof ec_config.mid!=undef){if(ec_config.mid!=63&&!hasstr(ecobj.ubi)){ecobj.ubi=getID();try{getIDFromIframe(setlsid,1e3)}catch(ignore){}}typeof ec_config.pid!=undef&&(ec_config.mid==48&&ec_config.pid.indexOf("cat")==0?umallfix(ec_config):ec_config.mid==5659&&(ec_config.pid=="transaction"?obdesignbuyfix(ec_config):ec_config.pid=="action"&&obdesigncartfix(ec_config)))}if(typeof ec_config.qu!=undef){if(ShouldQU()==!1)return;ec_config.qu=="0:0"&&(ec_config.qu="0:"+CheckIfQU())}hasstr(ecobj.u)&&(ec_config.u=ecobj.u,ec_config.u.length>1e3&&(ec_config.u=ec_config.u.substr(0,1e3)+"__T"),hasstr(ec_config.pid)&&ec_config.pid=="buy"&&delete ec_config.u),hasstr(ecobj.r)&&(ec_config.r=ecobj.r,ec_config.r.length>1e3&&(ec_config.r=ec_config.r.substr(0,1e3)+"__T")),hasstr(ecobj.msi)&&(ec_config.msi=ecobj.msi),hasstr(ecobj.ubi)&&(ec_config.ubi=ecobj.ubi),datafunc=function(a){eval("var data="+a+";"),typeof data!=undef&&data.length>0&&jQuery(ec_node).after(data)},typeof ec_config.success=="function"&&(datafunc=ec_config.success,delete ec_config.success),func=function(a,b){function IsVisited(n){jQuery("#"+taid).html('<a id="'+tiid+'" href="'+n+'">test<\/a>');var t=jQuery("#"+tiid).css("color");return t=="rgb(0, 0, 255)"||t=="#0000ff"}var taid="bwrectarea",tiid="bwrectitem",tresult,qrvalue,tarea,qurl,qset,qrstr,qr;if(datafunc(a),tresult={},eval("var qurls="+b+";"),typeof qurls!=undef&&(qrvalue=qurls.r,typeof qrvalue!=undef)){qurls.r=undef,tarea=jQuery("#"+taid),tarea.length==0&&(jQuery("body").append('<style type="text/css">.bwrect A:link {text-decoration: none;color:#FF0000;} .bwrect A:visited {text-decoration: none;color: #0000FF;}<\/style><div id="'+taid+'" class="bwrect" style="display:none"><\/div>'),tarea=jQuery("#"+taid));for(qurl in qurls)qset=qurls[qurl],tresult[qset]!=1&&IsVisited(qurl)&&(tresult[qset]=1);qrstr="";for(qr in tresult)qrstr+=qr+",";window.scupioec.call({qu:qrvalue+":"+qrstr})}},typeof ecobj.layout!=undef&&ecobj.layout=="none"&&(func=function(){}),typeof ec_config.carts=="string"&&typeof ec_config.pid==undef&&ec_config.carts.length==0&&(ec_config.pid="cart");var jshead=schemevar+"rec.scupio.com/recweb/rec.aspx?",jssrc=jshead+jQuery.param(ec_config),testlen=2e3;jssrc.length>testlen&&(hasstr(ec_config.r)&&(ec_config.r="__T",jssrc=jshead+jQuery.param(ec_config)),jssrc.length>testlen&&(hasstr(ec_config.u)&&(ec_config.u="__T"),jssrc=jshead+jQuery.param(ec_config))),datastr="window.scupioec.rec["+ec_rec_index+"].data",qustr="window.scupioec.rec["+ec_rec_index+"].qurls",importJS(jssrc,datastr,null,function(){func(datastr,qustr)})}}}function getID(){var n,t="";try{n=window.localStorage,typeof n=="object"&&typeof n.getItem=="function"&&(t=n.getItem("sclsid"),typeof t!="string"&&(t=""))}catch(i){}return t}function getIDFromIframe(n,t){function v(n,t,i){t.addEventListener?t.addEventListener(n,i,!1):t.attachEvent&&t.attachEvent("on"+n,i)}function y(n,t,i){t.removeEventListener?t.removeEventListener(n,i,!1):t.detachEvent&&t.detachEvent("on"+n,i)}function f(t){o||(o=!0,n(t),clearTimeout(s))}function h(n){if(n&&typeof n.origin=="string"&&n.origin.indexOf("//img.scupio.com")>=0){var t=n.data||n.message;y("message",window,h),f(t)}}var o=!1,s;if(typeof window.postMessage=="function"&&typeof window.localStorage=="object"){v("message",window,h);var c=window.document,r=c.createElement("iframe"),i=r.style,l="0",u="1",a="px",e;r.src="//img.scupio.com/test/lsid/ls.html?v=0.1",r.width=u,r.height=u,r.frameborder=l,r.allowtransparency="true",r.scrolling="no",i.position="absolute",i.width=u+a,i.height=u+a,i.bottom=i.left=i.margin=i.padding=i.border=l,i.overflow="hidden",e=c.getElementsByTagName("body")[0],e&&e.appendChild(r)}else f(null);s=setTimeout(f,t)}function setlsid(n){var t;try{t=window.localStorage,typeof t=="object"&&typeof t.setItem=="function"&&typeof n=="string"&&n!==""&&t.setItem("sclsid",n)}catch(i){}}var undef="undefined",httpvar="http://",httpsvar="https://",autoschemevar="//",schemevar="http://";document.location.href.indexOf(httpvar)!=-1?schemevar=autoschemevar:document.location.href.indexOf(httpsvar)!=-1&&(schemevar=autoschemevar),jqueryReady(function(){registerclick();var n=scupioec();n!=null?(callaspx(n),window.scupioec.flush()):jQuery(document).ready(function(){callaspx(scupioec()),window.scupioec.flush()})})})(window)